---
title: mipsçš„å †æ ˆ
tags: [assembly]
date: 2022-12-23 16:08:00
categories: [mipsæ±‡ç¼–]
excerpt: mipså †æ ˆçŸ¥è¯†
---

#### MIPSçš„æ ˆğŸ’£

1. æ ˆå¢é•¿æ–¹å‘ï¼šåŒx86ï¼Œå‘ä½åœ°å€å¢é•¿

2. æ²¡æœ‰EBPæŒ‡é’ˆï¼ˆä½†æ˜¯æœ‰ä¸€ä¸ªfpï¼Œè§MIPSæ±‡ç¼–è¿™ç¯‡æ–‡ç« ï¼‰
3. ä¼ å‚ï¼šå‰å››ä¸ªå‚æ•°é€šè¿‡$a0~$a3ä¼ é€’ï¼Œå¤šå‡ºçš„å‚æ•°æ”¾å…¥æ ˆç©ºé—´
4. è¿”å›å€¼ï¼š$RAå¯„å­˜å™¨ 

#### mipsä¸x86å‡½æ•°è°ƒç”¨åŒºåˆ«

1. å°†$PCå¯„å­˜å™¨ç§»åˆ°$RAå¯„å­˜å™¨
2. å¦‚æœè¢«è°ƒç”¨çš„å‡½æ•°æ˜¯å¦‚æœæ˜¯éå¶å‡½æ•°ï¼ˆè°ƒç”¨å…¶ä»–å‡½æ•°ï¼‰ï¼Œå°†$RAå­˜åœ¨æ ˆï¼›å¶å‡½æ•°åˆ™ä¸å˜
3. å‡½æ•°è¿”å›æ—¶ï¼Œå¶å‡½æ•°ç›´æ¥ `jr $RA`ï¼Œéå¶å‡½æ•°å…ˆæŠŠè¿”å›åœ°å€å­˜å…¥$RAå†è·³è½¬

ã€Šå®¶ç”¨è·¯ç”±å™¨0dayæ¼æ´æŒ–æ˜ã€‹è¿™æœ¬ä¹¦ä¸Šçš„å›¾ä¾‹ï¼š

![](/img/mips/1.jpg)



#### ä¸»è°ƒå‡½æ•°å¹²çš„äº‹

##### æ¼”ç¤º

1. åˆ›å»º `more argument.c`

   ```C
   //more argument.c
   #include <stdio.h>
   int more_arg(int a,int b,int c,int d,int e)
   {
       char dst[100] = {0};
       sprintf(dst,"%d%d%d%d%d\n",a,b,c,d,e);
   }
   void main()
   {
       int a1=1;
       int a2=2;
       int a3=3;
       int a4=4;
       int a5=5;
       more_arg(a1,a2,a3,a4,a5);
       return ;
   }
   ```

2. ç¼–è¯‘

   ```
   mips-linux-gnu-gcc ./more\ argument.c  -o   more\ argument
   ```

3. idaæ‰“å¼€

   é¦–å…ˆå¯ä»¥çœ‹åˆ°å‰å››ä¸ªå‚æ•°å­˜å…¥äº†$a0~$a3

   ![](/img/mips/2.jpg)

   ç„¶åå‰é¢5ä¸ªï¼š
   
   ```assembly
   li      $v0, ?
   sw      $v0, 0x??+var_18($fp)
   ```
   
   æ˜¯èµ‹å€¼æ“ä½œï¼Œå› æ­¤ä¸­é—´çš„
   
   ```assembly
   lw      $v0, 0x38+var_8($fp)
   sw      $v0, 0x38+var_28($sp)
   ```
   
   å³ä¸ºç¬¬äº”ä¸ªå‚æ•°çš„ä¼ é€’

   

#### è¢«è°ƒå‡½æ•°å¹²çš„äº‹

è¢«è°ƒç”¨å‡½æ•°çš„å¼€å¤´å¹²äº†ä»¥ä¸‹å‡ ä»¶äº‹ï¼ˆä»…é’ˆå¯¹éå¶å‡½æ•°ï¼‰ï¼š

```assembly
addiu   $sp, -0x40
sw      $ra, 0x38+var_s4($sp)
sw      $fp, 0x38+var_s0($sp)
move    $fp, $sp
```

é¦–å…ˆï¼ŒæŠ¬é«˜sp 0x40ä¸ªå­—èŠ‚***ï¼ˆè¿™é‡Œ0x40æ˜¯éšä¾¿å†™çš„ï¼‰***ã€‚ç„¶åå°†raæ”¾åˆ°`sp + 0x38 + 4`ï¼Œfpæ”¾åˆ°`sp + 0x38 + 0`çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯è¢«è°ƒå‡½æ•°çš„æ ˆåº•ä¸ºraï¼Œç„¶åæ˜¯fpã€‚æœ€åå°†fpèµ‹å€¼ä¸ºspã€‚

ç„¶åéœ€è¦å¯¹å‚æ•°è¿›è¡Œå¤„ç†ï¼Œarg_0 åˆ°arg_Cæ˜¯ä¸»è°ƒå‡½æ•°é¢„ç•™å‡ºæ¥çš„ç©ºé—´ï¼Œéœ€è¦è¢«è°ƒå‡½æ•°å†æŠŠ$a0-$a3å­˜å…¥è¿›å»ï¼Œç„¶åarg_10æœ¬èº«ä¸»è°ƒå‡½æ•°å°±å·²ç»å­˜å¥½äº†ç¬¬äº”ä¸ªå‚æ•°ï¼Œä¸éœ€è¦åŠ¨ã€‚

![](/img/mips/3.jpg)





æœ€ç»ˆä¸»è°ƒå’Œè¢«è°ƒå‡½æ•°çš„æ ˆé•¿è¿™æ ·ï¼š

![](/img/mips/4.jpg)